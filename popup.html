<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SnapDigest AI</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <div class="header-title">
      <svg class="logo-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2L2 7l10 5 10-5-10-5z"/>
        <path d="M2 17l10 5 10-5"/>
        <path d="M2 12l10 5 10-5"/>
      </svg>
      <h1>SnapDigest AI</h1>
      <button id="bento-open-panel-btn" type="button" class="side-panel-icon-btn" title="View Bento Grid in Side Panel" aria-label="View Bento Grid in Side Panel">
        <span class="indicator" aria-hidden="true"></span>
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="7" height="7"/>
          <rect x="14" y="3" width="7" height="7"/>
          <rect x="14" y="14" width="7" height="7"/>
          <rect x="3" y="14" width="7" height="7"/>
        </svg>
      </button>
    </div>
  </header>
  
  <div class="section-divider" id="divider-header"></div>
  
  <!-- Page Title Section (Article Title at the Top) -->
  <section class="page-title-section" id="page-title-section" hidden>
    <div class="page-title-wrapper">
      <span id="page-title" class="page-title">Page Title</span>
      <a id="page-link" class="page-link-inline" href="#" target="_blank" rel="noopener" title="Open original article">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
          <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
        </svg>
      </a>
    </div>
    <p id="status" class="status" role="status" aria-live="polite"></p>
  </section>
  
  <div class="section-divider" id="divider-1" hidden></div>
  
  <!-- Action Buttons (Above Text Section) -->
  <section class="action-bar">
    <button id="extract-btn" type="button" class="btn btn-primary" title="Extract visible text from the current page">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="16 18 22 12 16 6"/>
        <polyline points="8 6 2 12 8 18"/>
      </svg>
      Extract
    </button>
    <button id="refine-btn" type="button" class="btn btn-secondary" disabled title="Select elements to exclude from extraction">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 15V6M18.5 18a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5zM3 15V6M5.5 18a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5zM12 3v18"/>
      </svg>
      Exclude
    </button>
    <button id="reset-btn" type="button" class="btn btn-ghost" disabled title="Clear all exclusions and reset to original page text">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
        <path d="M21 3v5h-5"/>
      </svg>
      Reset
    </button>
    <button id="download-btn" type="button" class="btn btn-ghost" disabled title="Save extracted text as a text file">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="7 10 12 15 17 10"/>
        <line x1="12" y1="15" x2="12" y2="3"/>
      </svg>
      Save
    </button>
  </section>
  
  <div class="section-divider" id="divider-2"></div>
  
  <!-- Extracted Text Section (Below Action Buttons) -->
  <section class="content-section text-section empty" id="text-section">
    <h2>
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
        <polyline points="14 2 14 8 20 8"/>
      </svg>
      Extracted Text
      <span class="badge" id="count"></span>
    </h2>
    <div class="text-container-wrapper">
      <div id="text-container" class="text-container" tabindex="0" aria-label="Extracted page text"></div>
      <button id="copy-text-btn" type="button" class="copy-icon-btn" title="Copy extracted text" aria-label="Copy extracted text">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
          <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
        </svg>
      </button>
    </div>
  </section>
  
  <div class="section-divider" id="divider-3"></div>
  
  <section class="content-section" id="summary-section" hidden>
    <h2>
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 6v6l4 2"/>
      </svg>
      AI Summary
      <span class="badge" id="summary-badge"></span>
    </h2>
    
    <!-- Summarizer Controls inside Summary Section -->
    <div class="summarizer-controls-inline">
      <button id="summarize-btn" type="button" class="btn btn-accent" disabled title="Generate AI summary of extracted text using Chrome's built-in AI">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
          <polyline points="14 2 14 8 20 8"/>
          <line x1="16" y1="13" x2="8" y2="13"/>
          <line x1="16" y1="17" x2="8" y2="17"/>
          <line x1="10" y1="9" x2="8" y2="9"/>
        </svg>
        Summarize
      </button>
      <div class="select-group">
        <select id="summary-type" title="Choose summary format">
          <option value="tldr">TL;DR</option>
          <option value="teaser">Teaser</option>
          <option value="key-points" selected>Key Points</option>
          <option value="headline">Headline</option>
        </select>
        <select id="summary-length" title="Choose summary length">
          <option value="short">Short</option>
          <option value="medium">Medium</option>
          <option value="long" selected>Long</option>
        </select>
      </div>
    </div>
    
    <div class="text-container-wrapper">
      <div id="summary-container" class="text-container" tabindex="0" aria-label="Summary"></div>
      <button id="copy-summary-btn" type="button" class="copy-icon-btn" title="Copy summary" aria-label="Copy summary">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
          <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
        </svg>
      </button>
    </div>
    
    <!-- Bento Button at Bottom of Summary -->
    <button id="bento-btn" type="button" class="btn btn-bento-bottom" disabled title="Generate a summary first to create a Bento Grid">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="3" width="7" height="7"/>
        <rect x="14" y="3" width="7" height="7"/>
        <rect x="14" y="14" width="7" height="7"/>
        <rect x="3" y="14" width="7" height="7"/>
      </svg>
      Create Bento Grid
    </button>
  </section>
  
  <div class="section-divider" id="divider-4"></div>
  
  <section id="exclusion-section" class="exclusions" hidden>
    <h2>
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <line x1="15" y1="9" x2="9" y2="15"/>
        <line x1="9" y1="9" x2="15" y2="15"/>
      </svg>
      Excluded Elements
      <span class="badge" id="exclusion-badge"></span>
    </h2>
    <ul id="exclusion-list"></ul>
    <p class="hint">
      <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" y1="16" x2="12" y2="12"/>
        <line x1="12" y1="8" x2="12.01" y2="8"/>
      </svg>
      Right-click a dashed element on the page to restore it.
    </p>
  </section>
  <script src="popup.js"></script>
</body>
</html>
